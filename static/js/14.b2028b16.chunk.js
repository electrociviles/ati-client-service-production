(this.webpackJsonpati=this.webpackJsonpati||[]).push([[14],{1086:function(e,t,a){"use strict";a.r(t);var n=a(14),r=a(11),l=a(1),c=a.n(l),i=a(896),o=a(503),s=a(504),u=a(28),m=a(976),d=a(38),p=a(136),g=a(381),b=a(262),E=a(942),v=a(944),O=a(943),f=a(992),h=a(286),j=a.n(h),C=a(908),S=a(934),y=a(990),N=a(9),k=a(981),H=a(894),x=a(116),w=a.n(x),P=a(59),_=a(64),R=a(509),Y=a(68),A=a(380),B=a(144),T=a(79),W=a(902),z=a(3),D=a(963),I=Object(i.a)((function(e){return{root:{flexGrow:1},iconWidth:{width:10},paper:{padding:e.spacing(2),marginTop:10},button:{margin:e.spacing(1)},input:{display:"none"},fab:{margin:e.spacing(1)},extendedIcon:{marginRight:e.spacing(1)},icon:{marginRight:e.spacing(1),color:"black"}}})),F=function(e){var t=I();Object(l.useEffect)((function(){e.attention&&(o(e.attention),d(e.attention.subTotal),C(e.attention.imprevistos),O(e.attention.administracion),k(e.attention.utilidad),P(e.attention.ivaSobreUtilidad),B(e.attention.total))}),[]);var a=Object(l.useState)(null),r=Object(n.a)(a,2),i=r[0],o=r[1],s=Object(l.useState)(""),u=Object(n.a)(s,2),m=u[0],d=u[1],g=Object(l.useState)(""),E=Object(n.a)(g,2),v=E[0],O=E[1],f=Object(l.useState)(""),h=Object(n.a)(f,2),j=h[0],C=h[1],S=Object(l.useState)(""),y=Object(n.a)(S,2),N=y[0],k=y[1],H=Object(l.useState)(""),x=Object(n.a)(H,2),w=x[0],P=x[1],R=Object(l.useState)(""),Y=Object(n.a)(R,2),A=Y[0],B=Y[1],F=Object(l.useState)(!1),M=Object(n.a)(F,2),q=M[0],J=M[1],U=Object(l.useState)(""),G=Object(n.a)(U,2),L=G[0],V=G[1],K=Object(l.useState)(!1),Q=Object(n.a)(K,2),X=Q[0],Z=Q[1],$=Object(l.useState)(""),ee=Object(n.a)($,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(!1),re=Object(n.a)(ne,2),le=re[0],ce=re[1],ie=Object(l.useState)(""),oe=Object(n.a)(ie,2),se=oe[0],ue=oe[1],me=Object(l.useState)(!1),de=Object(n.a)(me,2),pe=de[0],ge=de[1],be=Object(l.useState)(""),Ee=Object(n.a)(be,2),ve=Ee[0],Oe=Ee[1],fe=Object(l.useState)(!1),he=Object(n.a)(fe,2),je=he[0],Ce=he[1],Se=Object(l.useState)(""),ye=Object(n.a)(Se,2),Ne=ye[0],ke=ye[1],He=Object(l.useState)(!1),xe=Object(n.a)(He,2),we=xe[0],Pe=xe[1],_e=Object(l.useState)(""),Re=Object(n.a)(_e,2),Ye=Re[0],Ae=Re[1],Be=function(e){var t=void 0!==e?e:m;return null==t||""===t.toString().trim()?(J(!0),V("Este campo es requerido"),1):(J(!1),V(""),0)},Te=function(e){var t=void 0!==e?e:v;return null==t||""===t.toString().trim()?(Z(!0),ae("Este campo es requerido"),1):(Z(!1),ae(""),0)},We=function(e){var t=void 0!==e?e:j;return null==t||""===t.toString().trim()?(ce(!0),ue("Este campo es requerido"),1):(ce(!1),ue(""),0)},ze=function(e){var t=void 0!==e?e:N;return null==t||""===t.toString().trim()?(ge(!0),Oe("Este campo es requerido"),1):(ge(!1),Oe(""),0)},De=function(e){var t=void 0!==e?e:w;return null==t||""===t.toString().trim()?(Ce(!0),ke("Este campo es requerido"),1):(Ce(!1),ke(""),0)},Ie=function(e){var t=void 0!==e?e:A;return null==t||""===t.toString().trim()?(Pe(!0),Ae("Este campo es requerido"),1):(Pe(!1),Ae(""),0)},Fe=function(){var e=0;return e+=Be(),e+=Te(),e+=We(),e+=ze(),e+=De(),e+=Ie()};return c.a.createElement(p.a,{className:t.paper},c.a.createElement(D.a,null),c.a.createElement("form",{encType:"multipart/form-data",onSubmit:function(t){t.preventDefault(),function(t){if(0===Fe()){var a={id:i._id,subtotal:m,administracion:v,imprevistos:j,utilidad:N,ivaSobreUtilidad:w,total:A,action:e.action};Object(_.J)(a).then((function(t){console.log("response",t),"success"==t.status?(e.onClose(!1),D.b.info(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),e.updateAttention(t.attention)):D.b.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))}}()}},c.a.createElement(T.a,{container:!0,spacing:3},c.a.createElement(T.a,{item:!0,xs:12,sm:6},c.a.createElement(W.a,{fullWidth:!0,error:q,helperText:L,className:Object(z.a)(t.margin,t.textField),variant:"outlined",label:"Subtotal",margin:"dense",type:"number",value:m,onChange:function(e){d(e.target.value),Be(e.target.value)}})),c.a.createElement(T.a,{item:!0,xs:12,sm:6},c.a.createElement(W.a,{fullWidth:!0,error:X,helperText:te,className:Object(z.a)(t.margin,t.textField),variant:"outlined",label:"Administraci\xf3n",margin:"dense",type:"number",value:v,onChange:function(e){O(e.target.value),Te(e.target.value)}})),c.a.createElement(T.a,{item:!0,xs:12,sm:6},c.a.createElement(W.a,{fullWidth:!0,error:le,helperText:se,className:Object(z.a)(t.margin,t.textField),variant:"outlined",label:"Imprevistos",margin:"dense",type:"number",value:j,onChange:function(e){C(e.target.value),We(e.target.value)}})),c.a.createElement(T.a,{item:!0,xs:12,sm:6},c.a.createElement(W.a,{fullWidth:!0,error:pe,helperText:ve,className:Object(z.a)(t.margin,t.textField),variant:"outlined",label:"Utilidad",margin:"dense",type:"number",value:N,onChange:function(e){k(e.target.value),ze(e.target.value)}})),c.a.createElement(T.a,{item:!0,xs:12,sm:6},c.a.createElement(W.a,{fullWidth:!0,error:je,helperText:Ne,className:Object(z.a)(t.margin,t.textField),variant:"outlined",label:"Iva sobre utilidad",margin:"dense",type:"number",value:w,onChange:function(e){P(e.target.value),De(e.target.value)}})),c.a.createElement(T.a,{item:!0,xs:12,sm:6},c.a.createElement(W.a,{fullWidth:!0,error:we,helperText:Ye,className:Object(z.a)(t.margin,t.textField),variant:"outlined",label:"Total",margin:"dense",type:"number",value:A,onChange:function(e){B(e.target.value),Ie(e.target.value)}})),c.a.createElement(T.a,{item:!0,xs:2,sm:12},c.a.createElement(b.a,{type:"submit",variant:"contained",color:"primary"},e.attention?"Actualizar":"Enviar")))))},M=a(897),q=a(898),J=a(937),U=a(936),G=(a(967),a(512),a(83)),L=a(991),V=a(378),K=a(180),Q=a.n(K),X=a(5),Z=a.n(X),$=Object(i.a)((function(e){return{root:{flexGrow:1},iconWidth:{width:10},paper:{padding:e.spacing(2),marginTop:10},button:{margin:e.spacing(1)},input:{display:"none"},fab:{margin:e.spacing(1)},extendedIcon:{marginRight:e.spacing(1)},icon:{marginRight:e.spacing(1),color:"black"}}})),ee=Object(N.a)((function(e){return{root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}))((function(e){var t=e.children,a=e.classes,n=e.onClose,l=Object(r.a)(e,["children","classes","onClose"]);return c.a.createElement(k.a,Object.assign({disableTypography:!0,className:a.root},l),c.a.createElement(P.a,{variant:"h6"},t),n?c.a.createElement(H.a,{"aria-label":"close",className:a.closeButton,onClick:n},c.a.createElement(w.a,null)):null)})),te=c.a.forwardRef((function(e,t){return c.a.createElement(C.a,Object.assign({direction:"up",ref:t},e))}));t.default=function(e){var t=Q()(localStorage.getItem("token"));Object(l.useEffect)((function(){C(["5a046fe9627e3526802b3847"]);var e={start:0,end:oe,paginate:!0};Object(_.s)(e).then((function(e){x(e.attentions),X(e.count)}))}),[]);var a=$(),r=Object(l.useState)([]),i=Object(n.a)(r,2),h=i[0],C=i[1],N=Object(l.useState)([]),k=Object(n.a)(N,2),H=k[0],x=k[1],w=Object(l.useState)(null),P=Object(n.a)(w,2),T=P[0],W=P[1],z=Object(l.useState)(0),I=Object(n.a)(z,2),K=I[0],X=I[1],ae=Object(l.useState)(0),ne=Object(n.a)(ae,2),re=ne[0],le=ne[1],ce=Object(l.useState)(10),ie=Object(n.a)(ce,2),oe=ie[0],se=ie[1],ue=Object(l.useState)(!1),me=Object(n.a)(ue,2),de=me[0],pe=me[1],ge=Object(l.useState)(!1),be=Object(n.a)(ge,2),Ee=be[0],ve=be[1],Oe=Object(l.useState)(!1),fe=Object(n.a)(Oe,2),he=fe[0],je=fe[1],Ce=Object(l.useState)(""),Se=Object(n.a)(Ce,2),ye=Se[0],Ne=Se[1],ke=Object(l.useState)(!1),He=Object(n.a)(ke,2),xe=He[0],we=He[1],Pe=function(){pe(!1)},_e=function(e){return function(){W(e),je(!0)}},Re=function(e){return function(){Object(_.D)(e._id).then((function(t){if("success"===t.status){D.b.success(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});var a=H.map((function(t){return e._id!==t._id||(t.status="created"),t}));x(a)}else D.b.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){console.log(e),D.b.error("Occurri\xf3 un error al abrir la atenci\xf3n",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))}},Ye=function(e){return function(){Object(_.a)(e._id).then((function(t){if("success"===t.status){D.b.info(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});var a=H.map((function(t){return e._id!==t._id||(t.status="finished"),t}));x(a)}else D.b.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){console.log(e),D.b.error("Occurri\xf3 un error al cerrar la atenci\xf3n",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))}},Ae=function(){je(!1)},Be=function(){ve(!1)},Te=function(e,t){return function(){Ne(t),W(e),ve(!0)}},We=function(e){return function(){we(!0),W(e)}},ze=function(){we(!1)},De=function(e){switch(e.statusSend){case"send":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Enviado"),c.a.createElement("div",{className:"dateHistory"},Z()(e.date).format("YYYY-MM-DD HH:mm:ss")));case"resend":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Reenviado"),c.a.createElement("div",{className:"dateHistory"},Z()(e.date).format("YYYY-MM-DD HH:mm:ss")));case"reject":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Rechazado"),c.a.createElement("div",{className:"dateHistory"},Z()(e.date).format("YYYY-MM-DD HH:mm:ss")));case"accept":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Aceptado"),c.a.createElement("div",{className:"dateHistory"},Z()(e.date).format("YYYY-MM-DD HH:mm:ss")))}};return c.a.createElement(l.Fragment,null,c.a.createElement(D.a,null),c.a.createElement(p.a,{className:a.paper},c.a.createElement(o.a,null,c.a.createElement(m.a,null,c.a.createElement(d.a,null,c.a.createElement(u.a,null,"NOMBRE"),c.a.createElement(u.a,null,"DESCRIPCI\xd3N"),c.a.createElement(u.a,null,"ESTADO"),c.a.createElement(u.a,null,"CLIENTE"),c.a.createElement(u.a,null,"VER"),c.a.createElement(u.a,null,"ABRIR/CERRAR"),c.a.createElement(u.a,{colSpan:3},"ACCIONES"))),c.a.createElement(s.a,null,H.map((function(e){return c.a.createElement(d.a,{key:e._id},c.a.createElement(u.a,null,e.title," "),c.a.createElement(u.a,null,e.description," "),c.a.createElement(u.a,null,"finished"===e.status?c.a.createElement(R.a,{style:{margin:1},label:"Cerrado",size:"small",variant:"outlined"}):c.a.createElement(R.a,{style:{margin:1},label:"Abierto",size:"small",color:"primary",variant:"outlined"}),"send"===e.statusSend?c.a.createElement(R.a,{style:{margin:1},label:"Enviada",color:"secondary",size:"small",variant:"outlined"}):"",function(e){switch(e){case"accept":return c.a.createElement(R.a,{label:"Aceptada",size:"small",color:"primary"});case"reject":return c.a.createElement(R.a,{label:"Rechazada",size:"small"});case"resend":return c.a.createElement(R.a,{label:"Reenviado",size:"small"});case"send":return c.a.createElement(R.a,{label:"Enviado",size:"small"})}}(e.statusSend)),c.a.createElement(u.a,null,e.customer.name),c.a.createElement(u.a,{className:a.iconWidth},c.a.createElement(S.a,{title:"Detalle",placement:"top"},c.a.createElement(j.a,{className:a.icon,onClick:_e(e)}))),c.a.createElement(u.a,{className:a.iconWidth},"finished"===e.status?c.a.createElement("div",{className:"wrapper-icon-attention"},c.a.createElement(Y.j,{className:"icon",onClick:Re(e)}),c.a.createElement("span",{className:"open-close"},"Abrir")):c.a.createElement("div",{className:"wrapper-icon-attention"},c.a.createElement(Y.e,{className:"icon",onClick:Ye(e)}),c.a.createElement("div",{className:"open-close"},"Cerrar"))),c.a.createElement(u.a,{className:a.iconWidth},"pending"==e.statusSend?c.a.createElement(S.a,{title:"Enviar cliente",placement:"top"},c.a.createElement("div",null,c.a.createElement(A.a,{className:"icon",onClick:Te(e,"create")}))):""),c.a.createElement(u.a,{className:a.iconWidth},h.includes(t.role)&&"reject"==e.statusSend?c.a.createElement(S.a,{title:"Editar",placement:"top"},c.a.createElement("div",null,c.a.createElement(V.a,{className:"icon",onClick:Te(e,"update")}))):""),c.a.createElement(u.a,{className:a.iconWidth},e.descriptions.length>0?c.a.createElement(S.a,{title:"Hisotoria",placement:"top"},c.a.createElement("div",null,c.a.createElement(B.b,{className:"icon",onClick:We(e)}))):""))})))),c.a.createElement(y.a,{rowsPerPageOptions:[10,25,100],component:"div",count:K,rowsPerPage:oe,page:re,onChangePage:function(e,t){le(t);var a={start:t*oe,end:oe,paginate:!0};Object(_.s)(a).then((function(e){x(e.attentions),X(e.count)}))},onChangeRowsPerPage:function(e){se(+e.target.value),le(0);var t={start:0,end:e.target.value,paginate:!0};Object(_.s)(t).then((function(e){x(e.attentions),X(e.count)}))}})),c.a.createElement(E.a,{open:Ee,onClose:Be},c.a.createElement(ee,{style:{cursor:"move"}},"Alerta"),c.a.createElement(O.a,null,c.a.createElement(f.a,null,c.a.createElement(F,{action:ye,attention:T,updateAttention:function e(t){console.log("updateAttention: ",e);var a=H.map((function(e){return t._id!==e._id?e:e=t}));x(a)},onClose:Be}))),c.a.createElement(v.a,null,c.a.createElement(b.a,{autoFocus:!0,onClick:Be,color:"primary"},"Cerrar"))),c.a.createElement(E.a,{open:de,onClose:Pe,"aria-labelledby":"draggable-dialog-title"},c.a.createElement(ee,{style:{cursor:"move"},id:"draggable-dialog-title"},"Alerta"),c.a.createElement(O.a,null,c.a.createElement(f.a,null,"Esta seguro de eliminar esta atenci\xf3n?")),c.a.createElement(v.a,null,c.a.createElement(b.a,{autoFocus:!0,onClick:Pe,color:"primary"},"NO"),c.a.createElement(b.a,{onClick:function(e){pe(!1),Object(_.h)(e).then((function(t){if("success"===t.status){D.b.success(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});var a=H.map((function(t){return e!==t._id||(t.status="deleted"),t}));x(a)}else D.b.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){D.b.error("Ocurri\xf3 un error al eliminar la atenci\xf3n",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))},color:"primary"},"SI"))),c.a.createElement(E.a,{fullWidth:!0,maxWidth:"lg",open:he,onClose:Ae,TransitionComponent:te},c.a.createElement(O.a,null,c.a.createElement(g.a,{attention:T})),c.a.createElement(v.a,null,c.a.createElement(b.a,{autoFocus:!0,onClick:Ae,color:"primary"},"Cerrar"))),c.a.createElement(E.a,{open:xe,onClose:ze},c.a.createElement(ee,null,"Historia"),c.a.createElement(O.a,null,c.a.createElement(f.a,null,c.a.createElement(M.a,{className:a.root},T?T.descriptions.map((function(e){return c.a.createElement(q.a,{alignItems:"flex-start"},c.a.createElement(U.a,null,function(e){switch(e){case"reject":return c.a.createElement(Y.b,{style:{fontSize:32,color:"red"}});case"send":return c.a.createElement(G.d,{style:{fontSize:32,color:"red"}});case"accept":return c.a.createElement(Y.a,{style:{fontSize:32,color:"green"}});case"resend":return c.a.createElement(L.a,{style:{fontSize:32,color:"silver"}})}}(e.statusSend)),c.a.createElement(J.a,{primary:De(e),secondary:e.description}))})):""))),c.a.createElement(v.a,null,c.a.createElement(b.a,{autoFocus:!0,onClick:ze,color:"primary"},"Cerrar"))))}}}]);
//# sourceMappingURL=14.b2028b16.chunk.js.map