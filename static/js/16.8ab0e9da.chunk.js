(this.webpackJsonpati=this.webpackJsonpati||[]).push([[16],{1089:function(e,t,a){"use strict";a.r(t);var n=a(14),l=a(1),r=a.n(l),c=a(896),i=a(136),o=a(79),s=a(974),u=a(1053),m=a(1054);function d(){var e=Object(u.a)(["\n  query reportsServices($start: Int, $end: Int, $startDate: Date, $endDate: Date, $status: String, $type: Int) {\n    reportsServices(start: $start, end: $end, startDate: $startDate, endDate: $endDate, status: $status, type: $type) {\n        services {\n            id\n            latitude\n            longitude\n            date\n            typeService\n            packs_service {\n                quantity\n                pack {\n                price\n                }\n            }\n            customer {\n                names\n            }\n            technical {\n                names\n            }\n            engineer {\n                names\n            }\n        }\n        totalFields\n      }\n}"]);return d=function(){return e},e}var p=a.n(m)()(d()),g=a(510),b=a(59),E=a(262),h=a(503),v=a(504),f=a(28),y=a(1031),O=a(976),j=a(1078),S=a(990),x=a(38),C=a(5),D=a.n(C),k=a(1055),w=a.n(k),T=a(984),$=a(15),P=a(18),F=a.n(P),I=a(942),R=a(944),_=a(943),A=a(981),N=a(902),M=(a(3),a(939)),W=a(64),q=a(988),B=a(915),J=a(1079),K=a(379),z=Object(c.a)((function(e){return{root:{flexGrow:1,height:250,minWidth:290},input:{display:"flex",padding:0,height:"auto"},paper:{padding:e.spacing(2),color:e.palette.text.secondary,marginTop:10,margin:5},button:{margin:e.spacing(1)},formControl:{margin:e.spacing(1)},icon:{width:24,height:24}}}));t.default=function(e){D()().locale("es");var t=Object(l.useState)(0),a=Object(n.a)(t,2),c=a[0],u=a[1],m=Object(l.useState)(10),d=Object(n.a)(m,2),C=d[0],k=d[1],P=Object(l.useState)(0),G=Object(n.a)(P,2),H=G[0],U=G[1],V=z(),L=Object(l.useState)(new Date),Q=Object(n.a)(L,2),X=Q[0],Y=Q[1],Z=Object(l.useState)(new Date),ee=Object(n.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(l.useState)(!1),le=Object(n.a)(ne,2),re=le[0],ce=le[1],ie=Object(l.useState)(""),oe=Object(n.a)(ie,2),se=oe[0],ue=oe[1],me=Object(l.useState)([]),de=Object(n.a)(me,2),pe=de[0],ge=de[1],be=Object(l.useState)(0),Ee=Object(n.a)(be,2),he=Ee[0],ve=Ee[1],fe=Object(l.useState)(1),ye=Object(n.a)(fe,2),Oe=ye[0],je=ye[1],Se=Object(l.useState)(""),xe=Object(n.a)(Se,2),Ce=xe[0],De=xe[1],ke=Object(l.useState)([]),we=Object(n.a)(ke,2),Te=we[0],$e=we[1],Pe=Object(l.useState)([]),Fe=Object(n.a)(Pe,2),Ie=Fe[0],Re=Fe[1],_e=Object(l.useState)(""),Ae=Object(n.a)(_e,2),Ne=Ae[0],Me=Ae[1],We=Object(l.useState)([]),qe=Object(n.a)(We,2),Be=qe[0],Je=qe[1],Ke=Object(l.useState)(""),ze=Object(n.a)(Ke,2),Ge=ze[0],He=ze[1];Object(l.useEffect)((function(){Object(W.o)().then((function(e){console.log("response",e),$e(e.attentionsTypes)})),Object(W.u)().then((function(e){console.log("response",e),Re(e.customers)}))}),[]);var Ue=Object(g.a)(p,{fetchPolicy:"no-cache",onCompleted:function(){var e=0;U(Qe.reportsServices.totalFields);var t=Qe.reportsServices.services.map((function(t,a){var n=0;return t.packs_service.map((function(e,t){n+=e.quantity*e.pack.price})),e+=n,t.subTotal=n,t}));ge(t),ve(e)}}),Ve=Object(n.a)(Ue,2),Le=Ve[0],Qe=Ve[1].data,Xe=function(){ce(!1)};return r.a.createElement(l.Fragment,null,r.a.createElement(s.a,{maxWidth:"lg"},r.a.createElement(i.a,{className:V.paper},r.a.createElement("form",{encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),function(e){console.log("startDate",X),console.log("endDate",te),console.log("customer",Ne),console.log("centerOfAttention",Ge),console.log("serviceType",Oe),console.log("serviceStatus",Ce)}()}},r.a.createElement(o.a,{container:!0},r.a.createElement(o.a,{item:!0,xs:12,sm:12},r.a.createElement(b.a,null,"Reporte de atenciones")),r.a.createElement(o.a,{item:!0,xs:12,sm:3},r.a.createElement(B.a,{utils:q.a},r.a.createElement(J.a,{disableFuture:!0,format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha inicial",value:X,onChange:function(e){Y(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),r.a.createElement(o.a,{item:!0,xs:12,sm:3},r.a.createElement(B.a,{utils:q.a},r.a.createElement(J.a,{format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha final",value:te,onChange:function(e){ae(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),r.a.createElement(o.a,{item:!0,xs:12,sm:3},r.a.createElement(N.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Cliente",value:Ne,onChange:function(e){Me(e.target.value),Object(W.t)({customer:e.target.value}).then((function(e){Je(e.centersOfAttention)}))}},Ie.map((function(e){return r.a.createElement(M.a,{key:e._id,value:e._id},e.name)})))),r.a.createElement(o.a,{item:!0,xs:12,sm:3},r.a.createElement(N.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Centro de atenci\xf3n",value:Ge,onChange:function(e){He(e.target.value)}},Be.map((function(e){return r.a.createElement(M.a,{key:e._id,value:e._id},e.title)})))),r.a.createElement(o.a,{item:!0,xs:12,sm:3},r.a.createElement(N.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Tipo de atenci\xf3n",value:Oe,onChange:function(e){je(e.target.value)}},Te.map((function(e){return r.a.createElement(M.a,{key:e._id,value:e._id},e.type)})))),r.a.createElement(o.a,{item:!0,xs:2,sm:3},r.a.createElement(N.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Estado de la atenci\xf3n",value:Ce,onChange:function(e){De(e.target.value)}},[{id:"all",text:"Todas"},{id:"accept",text:"Aceptada"},{id:"reject",text:"Rechazada"},{id:"resend",text:"Reenviada"}].map((function(e){return r.a.createElement(M.a,{key:e.id,value:e.id},e.text)})))),r.a.createElement(o.a,{item:!0,xs:2,sm:12},r.a.createElement(E.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:20}},"Consultar")))))),r.a.createElement(i.a,{className:V.paper},r.a.createElement(y.a,{className:V.container,style:{width:"100%"}},r.a.createElement(h.a,{stickyHeader:!0,"aria-label":"sticky table"},r.a.createElement(O.a,null,r.a.createElement(x.a,null,r.a.createElement(f.a,null,"Fecha"),r.a.createElement(f.a,null,"Cliente"),r.a.createElement(f.a,null,"Tipo de servicio"),r.a.createElement(f.a,null,"T\xe9cnico"),r.a.createElement(f.a,null,"Ingeniero"),r.a.createElement(f.a,{align:"right"},"Total"))),r.a.createElement(v.a,null,pe.map((function(e){return r.a.createElement(x.a,{hover:!0,role:"checkbox",tabIndex:-1,key:e.id},r.a.createElement(f.a,null,r.a.createElement(w.a,{format:"ll"},new Date(e.date))),r.a.createElement(f.a,null,e.customer.names),r.a.createElement(f.a,null,1===e.typeService?"Residencial":"Cr\xe9dito"),r.a.createElement(f.a,null,e.technical?e.technical.names:""),r.a.createElement(f.a,null,e.engineer?e.engineer.names:""),r.a.createElement(f.a,{align:"right"},r.a.createElement(T.a,{value:e.subTotal,displayType:"text",thousandSeparator:!0,prefix:"$"})))}))),pe.length>0?r.a.createElement(j.a,null,r.a.createElement(x.a,{hover:!0},r.a.createElement(f.a,null,r.a.createElement(K.b,{className:V.icon,onClick:function(){var e,t,a,n,l={data:pe,total:0,startDate:X,endDate:te};l.total=(e="es-CO",t="COP",a=0,n=he,new Intl.NumberFormat(e,{style:"currency",currency:t,minimumFractionDigits:a}).format(n)),console.log("url","".concat($.a.hostReport1)),F.a.post("".concat($.a.hostReport1),{shortid:"WaIAVAU",data:l}).then((function(e){console.log(e);var t="data:application/pdf;base64,"+e.data;ue(t),ce(!0)})).catch((function(e){console.log("error",e)}))}})),r.a.createElement(f.a,{colSpan:7,align:"right"},r.a.createElement(b.a,{variant:"h3"},r.a.createElement(T.a,{value:he,displayType:"text",thousandSeparator:!0,prefix:"$"}))))):null)),r.a.createElement(S.a,{rowsPerPageOptions:[10,25,100],component:"div",count:H,rowsPerPage:C,page:c,onChangePage:function(e,t){u(t),Le({variables:{start:t,end:C,startDate:X,endDate:te,status:Ce,type:Oe}})},onChangeRowsPerPage:function(e){k(+e.target.value),u(0)}})),r.a.createElement(I.a,{maxWidth:"lg",open:re,onClose:Xe,"aria-labelledby":"draggable-dialog-title"},r.a.createElement(A.a,{id:"draggable-dialog-title"},"Reporte de servicios"),r.a.createElement(_.a,null,r.a.createElement("iframe",{src:se,title:"Imprimir",height:"900px",width:"600px"})),r.a.createElement(R.a,null,r.a.createElement(E.a,{onClick:Xe,color:"primary"},"Cerrar"))))}}}]);
//# sourceMappingURL=16.8ab0e9da.chunk.js.map