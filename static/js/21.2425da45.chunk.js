(this.webpackJsonpati=this.webpackJsonpati||[]).push([[21],{1108:function(e,a,t){"use strict";t.r(a);var n=t(21),r=t(1),l=t.n(r),c=t(920),i=t(141),o=t(933),s=t(1004),m=t(72),u=t(73);function d(){var e=Object(m.a)(["\n  query reportsServices($start: Int, $end: Int, $startDate: Date, $endDate: Date, $status: String, $type: Int) {\n    reportsServices(start: $start, end: $end, startDate: $startDate, endDate: $endDate, status: $status, type: $type) {\n        services {\n            id\n            latitude\n            longitude\n            date\n            typeService\n            packs_service {\n                quantity\n                pack {\n                price\n                }\n            }\n            customer {\n                names\n            }\n            technical {\n                names\n            }\n            engineer {\n                names\n            }\n        }\n        totalFields\n      }\n}"]);return d=function(){return e},e}var p=t.n(u)()(d()),g=t(143),E=t(71),b=t(922),h=t(987),v=t(991),y=t(990),f=t(1006),O=t(988),j=t(1096),S=t(1106),D=t(989),x=t(5),C=t.n(x),k=t(970),w=t.n(k),$=t(971),P=t(100),T=t(241),F=t.n(T),I=t(932),R=t(1013),N=t(1012),M=t(1011),W=t(935),q=(t(3),t(925)),A=t(1086),B=t(894),J=t(1102),K=t(1034),_=Object(c.a)((function(e){return{root:{flexGrow:1,height:250,minWidth:290},input:{display:"flex",padding:0,height:"auto"},paper:{padding:e.spacing(2),color:e.palette.text.secondary,marginTop:10,margin:5},button:{margin:e.spacing(1)},formControl:{margin:e.spacing(1)},icon:{width:24,height:24}}}));a.default=function(e){C()().locale("es");var a=Object(r.useState)(0),t=Object(n.a)(a,2),c=t[0],m=t[1],u=Object(r.useState)(10),d=Object(n.a)(u,2),x=d[0],k=d[1],T=Object(r.useState)(0),z=Object(n.a)(T,2),G=z[0],H=z[1],U=_(),V=Object(r.useState)(new Date),L=Object(n.a)(V,2),Q=L[0],X=L[1],Y=Object(r.useState)(new Date),Z=Object(n.a)(Y,2),ee=Z[0],ae=Z[1],te=Object(r.useState)(!1),ne=Object(n.a)(te,2),re=ne[0],le=ne[1],ce=Object(r.useState)(""),ie=Object(n.a)(ce,2),oe=ie[0],se=ie[1],me=Object(r.useState)([]),ue=Object(n.a)(me,2),de=ue[0],pe=ue[1],ge=Object(r.useState)(0),Ee=Object(n.a)(ge,2),be=Ee[0],he=Ee[1],ve=Object(r.useState)(1),ye=Object(n.a)(ve,2),fe=ye[0],Oe=ye[1],je=Object(r.useState)(""),Se=Object(n.a)(je,2),De=Se[0],xe=Se[1],Ce=Object(g.a)(p,{fetchPolicy:"no-cache",onCompleted:function(){var e=0;H($e.reportsServices.totalFields);var a=$e.reportsServices.services.map((function(a,t){var n=0;return a.packs_service.map((function(e,a){n+=e.quantity*e.pack.price})),e+=n,a.subTotal=n,a}));pe(a),he(e)}}),ke=Object(n.a)(Ce,2),we=ke[0],$e=ke[1].data,Pe=function(){le(!1)};return l.a.createElement(r.Fragment,null,l.a.createElement(s.a,{maxWidth:"lg"},l.a.createElement(i.a,{className:U.paper},l.a.createElement("form",{encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),function(e){console.log("startDate",Q),console.log("endDate",ee);we({variables:{start:c,end:x,startDate:Q,endDate:ee,status:De,type:fe}})}()}},l.a.createElement(o.a,{container:!0},l.a.createElement(o.a,{item:!0,xs:12,sm:12},l.a.createElement(E.a,null,"Reporte de gastos")),l.a.createElement(o.a,{item:!0,xs:12,sm:3},l.a.createElement(B.a,{utils:A.a},l.a.createElement(J.a,{disableFuture:!0,format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha inicial",value:Q,onChange:function(e){X(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(o.a,{item:!0,xs:12,sm:3},l.a.createElement(B.a,{utils:A.a},l.a.createElement(J.a,{format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha final",value:ee,onChange:function(e){ae(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),l.a.createElement(o.a,{item:!0,xs:12,sm:3},l.a.createElement(W.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Tipo de servicio",value:fe,onChange:function(e){Oe(e.target.value)}},[{id:1,title:"Residencial"},{id:2,title:"Corporativa"}].map((function(e){return l.a.createElement(q.a,{key:e.id,value:e.id},e.title)})))),l.a.createElement(o.a,{item:!0,xs:2,sm:3},l.a.createElement(W.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Estado del servicio",value:De,onChange:function(e){xe(e.target.value)}},[{id:"finished",title:"Finalizadas"},{id:"created",title:"En proceso"}].map((function(e){return l.a.createElement(q.a,{key:e.id,value:e.id},e.title)})))),l.a.createElement(o.a,{item:!0,xs:2,sm:12},l.a.createElement(b.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:20}},"Consultar")))))),l.a.createElement(i.a,{className:U.paper},l.a.createElement(f.a,{className:U.container,style:{width:"100%"}},l.a.createElement(h.a,{stickyHeader:!0,"aria-label":"sticky table"},l.a.createElement(O.a,null,l.a.createElement(D.a,null,l.a.createElement(y.a,null,"Fecha"),l.a.createElement(y.a,null,"Cliente"),l.a.createElement(y.a,null,"Tipo de servicio"),l.a.createElement(y.a,null,"T\xe9cnico"),l.a.createElement(y.a,null,"Ingeniero"),l.a.createElement(y.a,{align:"right"},"Total"))),l.a.createElement(v.a,null,de.map((function(e){return l.a.createElement(D.a,{hover:!0,role:"checkbox",tabIndex:-1,key:e.id},l.a.createElement(y.a,null,l.a.createElement(w.a,{format:"ll"},new Date(e.date))),l.a.createElement(y.a,null,e.customer.names),l.a.createElement(y.a,null,1===e.typeService?"Residencial":"Cr\xe9dito"),l.a.createElement(y.a,null,e.technical?e.technical.names:""),l.a.createElement(y.a,null,e.engineer?e.engineer.names:""),l.a.createElement(y.a,{align:"right"},l.a.createElement($.a,{value:e.subTotal,displayType:"text",thousandSeparator:!0,prefix:"$"})))}))),de.length>0?l.a.createElement(j.a,null,l.a.createElement(D.a,{hover:!0},l.a.createElement(y.a,null,l.a.createElement(K.a,{className:U.icon,onClick:function(){var e,a,t,n,r={data:de,total:0,startDate:Q,endDate:ee};r.total=(e="es-CO",a="COP",t=0,n=be,new Intl.NumberFormat(e,{style:"currency",currency:a,minimumFractionDigits:t}).format(n)),console.log("url","".concat(P.a.hostReport1)),F.a.post("".concat(P.a.hostReport1),{shortid:"WaIAVAU",data:r}).then((function(e){console.log(e);var a="data:application/pdf;base64,"+e.data;se(a),le(!0)})).catch((function(e){console.log("error",e)}))}})),l.a.createElement(y.a,{colSpan:7,align:"right"},l.a.createElement(E.a,{variant:"h3"},l.a.createElement($.a,{value:be,displayType:"text",thousandSeparator:!0,prefix:"$"}))))):null)),l.a.createElement(S.a,{rowsPerPageOptions:[10,25,100],component:"div",count:G,rowsPerPage:x,page:c,onChangePage:function(e,a){m(a),we({variables:{start:a,end:x,startDate:Q,endDate:ee,status:De,type:fe}})},onChangeRowsPerPage:function(e){k(+e.target.value),m(0)}})),l.a.createElement(I.a,{maxWidth:"lg",open:re,onClose:Pe,"aria-labelledby":"draggable-dialog-title"},l.a.createElement(M.a,{id:"draggable-dialog-title"},"Reporte de servicios"),l.a.createElement(N.a,null,l.a.createElement("iframe",{src:oe,title:"Imprimir",height:"900px",width:"600px"})),l.a.createElement(R.a,null,l.a.createElement(b.a,{onClick:Pe,color:"primary"},"Cerrar"))))}}}]);
//# sourceMappingURL=21.2425da45.chunk.js.map