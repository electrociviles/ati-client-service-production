(this.webpackJsonpati=this.webpackJsonpati||[]).push([[20],{1067:function(e,t,a){"use strict";var n=a(1068),r=a(1069);function c(){var e=Object(n.a)(["\n  query reportsServices($start: Int, $end: Int, $startDate: Date, $endDate: Date, $status: String, $type: Int) {\n    reportsServices(start: $start, end: $end, startDate: $startDate, endDate: $endDate, status: $status, type: $type) {\n        services {\n            id\n            latitude\n            longitude\n            date\n            typeService\n            packs_service {\n                quantity\n                pack {\n                price\n                }\n            }\n            customer {\n                names\n            }\n            technical {\n                names\n            }\n            engineer {\n                names\n            }\n        }\n        totalFields\n      }\n}"]);return c=function(){return e},e}a.n(r)()(c())},1149:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a(1),c=a.n(r),l=a(976),i=a(130),o=a(81),s=a(982),u=(a(1067),a(56)),m=a(233),d=a(294),b=a(295),p=a(23),E=a(986),g=a(983),f=a(999),O=a(979),j=a(34),h=a(5),v=a.n(h),y=a(1066),S=a.n(y),D=a(1063),x=(a(11),a(96),a(756)),w=a(758),C=a(757),k=a(978),$=a(520),P=(a(3),a(595)),T=a(42),A=a(319),F=a.n(A),I=a(985),J=a(1070),_=a(981),N=a(1150),q=a(325),M=a(1051),R=Object(l.a)((function(e){return{root:{flexGrow:1,height:250,minWidth:290},input:{display:"flex",padding:0,height:"auto"},paper:{padding:e.spacing(2),color:e.palette.text.secondary,marginTop:10,margin:5},button:{margin:e.spacing(1)},formControl:{margin:e.spacing(1)},icon:{width:24,height:24}}}));t.default=function(e){v()().locale("es");var t=Object(r.useState)(0),a=Object(n.a)(t,2),l=a[0],h=a[1],y=Object(r.useState)(10),A=Object(n.a)(y,2),W=A[0],z=A[1],B=Object(r.useState)(0),K=Object(n.a)(B,2),G=K[0],H=K[1],L=R(),Q=Object(r.useState)(new Date),U=Object(n.a)(Q,2),V=U[0],X=U[1],Y=Object(r.useState)(new Date),Z=Object(n.a)(Y,2),ee=Z[0],te=Z[1],ae=Object(r.useState)(!1),ne=Object(n.a)(ae,2),re=ne[0],ce=ne[1],le=Object(r.useState)(""),ie=Object(n.a)(le,2),oe=ie[0],se=ie[1],ue=Object(r.useState)([]),me=Object(n.a)(ue,2),de=me[0],be=me[1],pe=Object(r.useState)(0),Ee=Object(n.a)(pe,2),ge=Ee[0],fe=Ee[1],Oe=Object(r.useState)(1),je=Object(n.a)(Oe,2),he=(je[0],je[1],Object(r.useState)("")),ve=Object(n.a)(he,2),ye=ve[0],Se=ve[1],De=Object(r.useState)([]),xe=Object(n.a)(De,2),we=(xe[0],xe[1],Object(r.useState)([])),Ce=Object(n.a)(we,2),ke=Ce[0],$e=Ce[1],Pe=Object(r.useState)(""),Te=Object(n.a)(Pe,2),Ae=Te[0],Fe=Te[1],Ie=Object(r.useState)([]),Je=Object(n.a)(Ie,2),_e=Je[0],Ne=Je[1],qe=Object(r.useState)(""),Me=Object(n.a)(qe,2),Re=Me[0],We=Me[1],ze=Object(r.useState)(!1),Be=Object(n.a)(ze,2),Ke=(Be[0],Be[1],Object(r.useState)(null)),Ge=Object(n.a)(Ke,2),He=(Ge[0],Ge[1],Object(r.useState)(!1)),Le=Object(n.a)(He,2),Qe=Le[0],Ue=Le[1],Ve=Object(r.useState)(""),Xe=Object(n.a)(Ve,2),Ye=Xe[0],Ze=Xe[1],et=Object(r.useState)(!1),tt=Object(n.a)(et,2),at=tt[0],nt=tt[1],rt=Object(r.useState)(""),ct=Object(n.a)(rt,2),lt=ct[0],it=ct[1],ot=Object(r.useState)(!1),st=Object(n.a)(ot,2),ut=st[0],mt=st[1];Object(r.useEffect)((function(){Object(T.D)({}).then((function(e){$e(e.customers)}))}),[]);var dt=function(e){var t=void 0!==e?e:Ae;return null==t||""===t.toString().trim()?(Ue(!0),Ze("Este campo es requerido"),1):(Ue(!1),Ze(""),0)},bt=function(e){var t=void 0!==e?e:Re;return null==t||""===t.toString().trim()?(nt(!0),it("Este campo es requerido"),1):(nt(!1),it(""),0)},pt=function(){ce(!1)},Et=function(e){if(0===function(){var e=0,t=F()(localStorage.getItem("token"));return"5a046fe9627e3526802b3847"!==t.role&&(e+=dt()),"627d968a96a6a6b76f30c7e9"==t.role&&(e+=bt()),e}()){var t={start:0,end:W,paginate:!0,startDate:V,endDate:ee,customer:Ae,centerOfAttention:Re,maintenanceStatus:ye,source:"web"};Object(T.J)(t).then((function(e){var t=0;H(e.count);var a=e.maintenances.map((function(e,a){return console.log("maintenance ",e.total),e.total&&(t+=e.total),e}));be(a),fe(t)}))}};return c.a.createElement(r.Fragment,null,c.a.createElement(M.a,null),c.a.createElement(s.a,{maxWidth:"lg"},c.a.createElement(i.a,{className:L.paper},c.a.createElement("form",{encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),Et()}},c.a.createElement(o.a,{container:!0},c.a.createElement(o.a,{item:!0,xs:12,sm:12},c.a.createElement(u.a,null,c.a.createElement("b",null,"Reporte de mantenimientos"))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement(_.a,{utils:J.a},c.a.createElement(N.a,{disableFuture:!0,format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha inicial",value:V,onChange:function(e){X(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement(_.a,{utils:J.a},c.a.createElement(N.a,{format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha final",value:ee,onChange:function(e){te(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement($.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Cliente",error:Qe,helperText:Ye,value:Ae,onChange:function(e){Fe(e.target.value),Object(T.C)({}).then((function(e){Ne(e.centersOfAttention)}))}},ke.map((function(e){return c.a.createElement(P.a,{key:e._id,value:e._id},e.name)})))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement($.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Centro de atenci\xf3n",error:at,helperText:lt,value:Re,onChange:function(e){We(e.target.value)}},_e.map((function(e){return c.a.createElement(P.a,{key:e._id,value:e._id},e.title)})))),c.a.createElement(o.a,{item:!0,xs:2,sm:3},c.a.createElement($.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Estado del mantenimiento",value:ye,onChange:function(e){Se(e.target.value)}},[{id:"",text:"Todas"},{id:"active",text:"Activo"},{id:"finished",text:"Finalizado"}].map((function(e){return c.a.createElement(P.a,{key:e.id,value:e.id},e.text)})))),c.a.createElement(o.a,{item:!0,xs:2,sm:12},c.a.createElement(m.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:20}},"Consultar")))))),c.a.createElement(i.a,{className:L.paper},c.a.createElement(E.a,{className:L.container,style:{width:"100%"}},c.a.createElement(d.a,{stickyHeader:!0,"aria-label":"sticky table"},c.a.createElement(g.a,null,c.a.createElement(j.a,null,c.a.createElement(p.a,null,"Fecha"),c.a.createElement(p.a,null,"N\xfamero"),c.a.createElement(p.a,null,"Cliente"),c.a.createElement(p.a,null,"Tableros"),c.a.createElement(p.a,null,"Detalle"),c.a.createElement(p.a,null,"Enviar informe"),c.a.createElement(p.a,{width:30},"Descargar informe"))),c.a.createElement(b.a,null,de.map((function(e){return c.a.createElement(j.a,{hover:!0,key:e._id},c.a.createElement(p.a,null,c.a.createElement(S.a,{format:"ll"},new Date(e.date))),c.a.createElement(p.a,null,e.maintenanceType.name),c.a.createElement(p.a,null,e.customer.name),c.a.createElement(p.a,null,e.title),c.a.createElement(p.a,null,e.description),c.a.createElement(p.a,null,e.centerOfAttention?e.centerOfAttention.title:""))}))),de.length>0?c.a.createElement(f.a,null,c.a.createElement(j.a,{hover:!0},c.a.createElement(p.a,null,ut?c.a.createElement(I.a,{size:16}):c.a.createElement(q.b,{className:L.icon,onClick:function(){mt(!0);var e={start:0,end:W,paginate:!0,startDate:V,endDate:ee,customer:Ae,centerOfAttention:Re,maintenancesReport:T.J,source:"web"};Object(T.I)(e).then((function(e){if(mt(!1),"success"===e.status){var t="data:application/pdf;base64,"+e.data;se(t),ce(!0)}})).catch((function(e){console.log(e),mt(!1)}))}})),c.a.createElement(p.a,{colSpan:7,align:"right"},c.a.createElement(u.a,{variant:"h3"},c.a.createElement(D.a,{value:ge,displayType:"text",thousandSeparator:!0,prefix:"$"}))))):null)),c.a.createElement(O.a,{rowsPerPageOptions:[10,25,100],component:"div",count:G,rowsPerPage:W,page:l,onChangePage:function(e,t){var a={start:t*W,end:W,paginate:!0,startDate:V,endDate:ee,customer:Ae,centerOfAttention:Re,maintenanceStatus:ye,source:"web"};h(t),Object(T.J)(a).then((function(e){be(e.maintenances),H(e.count)}))},onChangeRowsPerPage:function(e){z(+e.target.value),h(0);var t={start:0,end:e.target.value,paginate:!0,startDate:V,endDate:ee,customer:Ae,centerOfAttention:Re,maintenanceStatus:ye,source:"web"};Object(T.J)(t).then((function(e){be(e.maintenances),H(e.count)}))}})),c.a.createElement(x.a,{maxWidth:"lg",open:re,onClose:pt,"aria-labelledby":"draggable-dialog-title"},c.a.createElement(k.a,{id:"draggable-dialog-title"},"Reporte de servicios"),c.a.createElement(C.a,null,c.a.createElement("iframe",{src:oe,title:"Imprimir",height:"900px",width:"600px"})),c.a.createElement(w.a,null,c.a.createElement(m.a,{onClick:pt,color:"primary"},"Cerrar"))))}}}]);
//# sourceMappingURL=20.75dc2bb1.chunk.js.map