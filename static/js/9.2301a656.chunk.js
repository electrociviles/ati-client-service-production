(this.webpackJsonpati=this.webpackJsonpati||[]).push([[9],{1058:function(e,t,a){"use strict";var n=a(1059),r=a(1060);function c(){var e=Object(n.a)(["\n  query reportsServices($start: Int, $end: Int, $startDate: Date, $endDate: Date, $status: String, $type: Int) {\n    reportsServices(start: $start, end: $end, startDate: $startDate, endDate: $endDate, status: $status, type: $type) {\n        services {\n            id\n            latitude\n            longitude\n            date\n            typeService\n            packs_service {\n                quantity\n                pack {\n                price\n                }\n            }\n            customer {\n                names\n            }\n            technical {\n                names\n            }\n            engineer {\n                names\n            }\n        }\n        totalFields\n      }\n}"]);return c=function(){return e},e}a.n(r)()(c())},1138:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a(1),c=a.n(r),l=a(966),i=a(130),o=a(82),s=a(973),u=(a(1058),a(57)),m=a(228),d=a(288),p=a(289),b=a(23),g=a(976),E=a(974),f=a(989),O=a(972),h=a(35),v=a(5),j=a.n(v),y=a(1057),S=a.n(y),D=a(1052),w=a(11),x=(a(97),a(746)),C=a(748),k=a(747),P=a(970),$=a(511),_=(a(3),a(585)),T=a(43),A=a(314),N=a.n(A),F=a(576),B=a(975),I=a(1053),q=a(968),H=a(1139),M=a(320),R=a(46),W=a(1041),z=Object(l.a)((function(e){return{root:{flexGrow:1,height:250,minWidth:290},input:{display:"flex",padding:0,height:"auto"},paper:{padding:e.spacing(2),color:e.palette.text.secondary,marginTop:10,margin:5},button:{margin:e.spacing(1)},formControl:{margin:e.spacing(1)},icon:{width:24,height:24}}}));t.default=function(e){j()().locale("es");var t=Object(r.useState)(0),a=Object(n.a)(t,2),l=a[0],v=a[1],y=Object(r.useState)(10),A=Object(n.a)(y,2),J=A[0],K=A[1],G=Object(r.useState)(0),L=Object(n.a)(G,2),Q=L[0],U=L[1],V=z(),X=Object(r.useState)(new Date),Y=Object(n.a)(X,2),Z=Y[0],ee=Y[1],te=Object(r.useState)(new Date),ae=Object(n.a)(te,2),ne=ae[0],re=ae[1],ce=Object(r.useState)(!1),le=Object(n.a)(ce,2),ie=le[0],oe=le[1],se=Object(r.useState)(""),ue=Object(n.a)(se,2),me=ue[0],de=ue[1],pe=Object(r.useState)([]),be=Object(n.a)(pe,2),ge=be[0],Ee=be[1],fe=Object(r.useState)(0),Oe=Object(n.a)(fe,2),he=Oe[0],ve=Oe[1],je=Object(r.useState)(1),ye=Object(n.a)(je,2),Se=(ye[0],ye[1],Object(r.useState)("")),De=Object(n.a)(Se,2),we=De[0],xe=De[1],Ce=Object(r.useState)([]),ke=Object(n.a)(Ce,2),Pe=(ke[0],ke[1],Object(r.useState)([])),$e=Object(n.a)(Pe,2),_e=$e[0],Te=$e[1],Ae=Object(r.useState)(""),Ne=Object(n.a)(Ae,2),Fe=Ne[0],Be=Ne[1],Ie=Object(r.useState)([]),qe=Object(n.a)(Ie,2),He=qe[0],Me=qe[1],Re=Object(r.useState)(""),We=Object(n.a)(Re,2),ze=We[0],Je=We[1],Ke=Object(r.useState)(!1),Ge=Object(n.a)(Ke,2),Le=(Ge[0],Ge[1],Object(r.useState)(null)),Qe=Object(n.a)(Le,2),Ue=(Qe[0],Qe[1],Object(r.useState)(!1)),Ve=Object(n.a)(Ue,2),Xe=Ve[0],Ye=Ve[1],Ze=Object(r.useState)(""),et=Object(n.a)(Ze,2),tt=et[0],at=et[1],nt=Object(r.useState)(!1),rt=Object(n.a)(nt,2),ct=rt[0],lt=rt[1],it=Object(r.useState)(""),ot=Object(n.a)(it,2),st=ot[0],ut=ot[1],mt=Object(r.useState)(!1),dt=Object(n.a)(mt,2),pt=dt[0],bt=dt[1];Object(r.useEffect)((function(){Object(T.y)({}).then((function(e){Te(e.customers)}))}),[]);var gt=function(e){var t=void 0!==e?e:Fe;return null==t||""===t.toString().trim()?(Ye(!0),at("Este campo es requerido"),1):(Ye(!1),at(""),0)},Et=function(e){var t=void 0!==e?e:ze;return null==t||""===t.toString().trim()?(lt(!0),ut("Este campo es requerido"),1):(lt(!1),ut(""),0)},ft=function(){oe(!1)},Ot=function(e){if(0===function(){var e=0,t=N()(localStorage.getItem("token"));return"5a046fe9627e3526802b3847"!==t.role&&(e+=gt()),"627d968a96a6a6b76f30c7e9"==t.role&&(e+=Et()),e}()){var t={start:0,end:J,paginate:!0,startDate:Z,endDate:ne,customer:Fe,centerOfAttention:ze,maintenanceStatus:we,source:"web"};Object(T.D)(t).then((function(e){var t=0;U(e.count);var a=e.maintenances.map((function(e,a){return console.log("maintenance ",e.total),e.total&&(t+=e.total),e}));Ee(a),ve(t)}))}},ht=function(e){return function(){var t=ge.map((function(t){return t._id===e._id&&(t.downloading=!0),t}));Ee(t);var a={id:e._id};Object(T.E)(a).then((function(t){var a=ge.map((function(t){return t._id===e._id&&(t.downloading=!1),t}));Ee(a),console.log(t),"success"===t.status?(W.b.info(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),Ee(a),window.open("".concat(w.a.urlPdf).concat(e._id,".pdf"))):W.b.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){W.b.error("Occurri\xf3 un error al descargar la atenci\xf3n",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))}};return c.a.createElement(r.Fragment,null,c.a.createElement(W.a,null),c.a.createElement(s.a,{maxWidth:"lg"},c.a.createElement(i.a,{className:V.paper},c.a.createElement("form",{encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),Ot()}},c.a.createElement(o.a,{container:!0},c.a.createElement(o.a,{item:!0,xs:12,sm:12},c.a.createElement(u.a,null,c.a.createElement("b",null,"Reporte de mantenimientos"))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement(q.a,{utils:I.a},c.a.createElement(H.a,{disableFuture:!0,format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha inicial",value:Z,onChange:function(e){ee(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement(q.a,{utils:I.a},c.a.createElement(H.a,{format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha final",value:ne,onChange:function(e){re(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement($.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Cliente",error:Xe,helperText:tt,value:Fe,onChange:function(e){Be(e.target.value),Object(T.x)({}).then((function(e){Me(e.centersOfAttention)}))}},_e.map((function(e){return c.a.createElement(_.a,{key:e._id,value:e._id},e.name)})))),c.a.createElement(o.a,{item:!0,xs:12,sm:3},c.a.createElement($.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Centro de atenci\xf3n",error:ct,helperText:st,value:ze,onChange:function(e){Je(e.target.value)}},He.map((function(e){return c.a.createElement(_.a,{key:e._id,value:e._id},e.title)})))),c.a.createElement(o.a,{item:!0,xs:2,sm:3},c.a.createElement($.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Estado del mantenimiento",value:we,onChange:function(e){xe(e.target.value)}},[{id:"",text:"Todas"},{id:"active",text:"Activo"},{id:"finished",text:"Finalizado"}].map((function(e){return c.a.createElement(_.a,{key:e.id,value:e.id},e.text)})))),c.a.createElement(o.a,{item:!0,xs:2,sm:12},c.a.createElement(m.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:20}},"Consultar")))))),c.a.createElement(i.a,{className:V.paper},c.a.createElement(g.a,{className:V.container,style:{width:"100%"}},c.a.createElement(d.a,{stickyHeader:!0,"aria-label":"sticky table"},c.a.createElement(E.a,null,c.a.createElement(h.a,null,c.a.createElement(b.a,null,"Fecha"),c.a.createElement(b.a,null,"N\xfamero"),c.a.createElement(b.a,null,"Cliente"),c.a.createElement(b.a,null,"Tableros"),c.a.createElement(b.a,null,"Detalle"),c.a.createElement(b.a,null,"Enviar informe"),c.a.createElement(b.a,{width:30},"Descargar informe"))),c.a.createElement(p.a,null,ge.map((function(e){return c.a.createElement(h.a,{hover:!0,key:e._id},c.a.createElement(b.a,null,c.a.createElement(S.a,{format:"ll"},new Date(e.date))),c.a.createElement(b.a,null,e.attentionType.type),c.a.createElement(b.a,null,e.customer.name),c.a.createElement(b.a,null,e.title),c.a.createElement(b.a,null,e.description),c.a.createElement(b.a,null,e.centerOfAttention?e.centerOfAttention.title:""),c.a.createElement(b.a,{className:V.iconWidth},c.a.createElement(F.a,{title:"Descargar",placement:"top"},e.downloading?c.a.createElement("div",{className:"circularProgress"},c.a.createElement(B.a,{size:16})):c.a.createElement("div",null,c.a.createElement(R.c,{className:"icon",onClick:ht(e)})))),c.a.createElement(b.a,{align:"right"},c.a.createElement(D.a,{value:e.total,displayType:"text",thousandSeparator:!0,prefix:"$"})))}))),ge.length>0?c.a.createElement(f.a,null,c.a.createElement(h.a,{hover:!0},c.a.createElement(b.a,null,pt?c.a.createElement(B.a,{size:16}):c.a.createElement(M.b,{className:V.icon,onClick:function(){bt(!0);var e={start:0,end:J,paginate:!0,startDate:Z,endDate:ne,customer:Fe,centerOfAttention:ze,maintenancesReport:T.D,source:"web"};Object(T.C)(e).then((function(e){if(bt(!1),"success"===e.status){var t="data:application/pdf;base64,"+e.data;de(t),oe(!0)}})).catch((function(e){console.log(e),bt(!1)}))}})),c.a.createElement(b.a,{colSpan:7,align:"right"},c.a.createElement(u.a,{variant:"h3"},c.a.createElement(D.a,{value:he,displayType:"text",thousandSeparator:!0,prefix:"$"}))))):null)),c.a.createElement(O.a,{rowsPerPageOptions:[10,25,100],component:"div",count:Q,rowsPerPage:J,page:l,onChangePage:function(e,t){var a={start:t*J,end:J,paginate:!0,startDate:Z,endDate:ne,customer:Fe,centerOfAttention:ze,maintenanceStatus:we,source:"web"};v(t),Object(T.D)(a).then((function(e){Ee(e.maintenances),U(e.count)}))},onChangeRowsPerPage:function(e){K(+e.target.value),v(0);var t={start:0,end:e.target.value,paginate:!0,startDate:Z,endDate:ne,customer:Fe,centerOfAttention:ze,maintenanceStatus:we,source:"web"};Object(T.D)(t).then((function(e){Ee(e.maintenances),U(e.count)}))}})),c.a.createElement(x.a,{maxWidth:"lg",open:ie,onClose:ft,"aria-labelledby":"draggable-dialog-title"},c.a.createElement(P.a,{id:"draggable-dialog-title"},"Reporte de servicios"),c.a.createElement(k.a,null,c.a.createElement("iframe",{src:me,title:"Imprimir",height:"900px",width:"600px"})),c.a.createElement(C.a,null,c.a.createElement(m.a,{onClick:ft,color:"primary"},"Cerrar"))))}}}]);
//# sourceMappingURL=9.2301a656.chunk.js.map