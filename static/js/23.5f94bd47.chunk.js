(this.webpackJsonpati=this.webpackJsonpati||[]).push([[23],{1147:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a(1),c=a.n(r),l=a(976),i=a(130),s=a(81),o=a(982),m=a(56),u=a(233),d=a(294),p=a(295),E=a(23),g=a(986),b=a(983),f=a(999),v=a(979),h=a(34),O=a(5),y=a.n(O),j=a(1066),S=a.n(j),w=a(1063),C=a(11),x=(a(96),a(756)),D=a(758),H=a(757),N=a(978),k=a(520),_=a(595),T=a(42),Y=a(319),P=a.n(Y),M=a(585),A=a(167),z=a(507),R=a(508),F=a(593),B=a(592),I=a(980),W=a(985),K=a(1070),q=a(981),J=a(1150),$=a(325),G=a(45),L=a(92),Q=a(1060),U=a(1051),V=Object(l.a)((function(e){return{root:{flexGrow:1,height:250,minWidth:290},input:{display:"flex",padding:0,height:"auto"},paper:{padding:e.spacing(2),color:e.palette.text.secondary,marginTop:10,margin:5},button:{margin:e.spacing(1)},formControl:{margin:e.spacing(1)},icon:{width:24,height:24}}}));t.default=function(e){y()().locale("es");var t=Object(r.useState)(0),a=Object(n.a)(t,2),l=a[0],O=a[1],j=Object(r.useState)(10),Y=Object(n.a)(j,2),X=Y[0],Z=Y[1],ee=Object(r.useState)(0),te=Object(n.a)(ee,2),ae=te[0],ne=te[1],re=V(),ce=Object(r.useState)(new Date),le=Object(n.a)(ce,2),ie=le[0],se=le[1],oe=Object(r.useState)(new Date),me=Object(n.a)(oe,2),ue=me[0],de=me[1],pe=Object(r.useState)(!1),Ee=Object(n.a)(pe,2),ge=Ee[0],be=Ee[1],fe=Object(r.useState)(""),ve=Object(n.a)(fe,2),he=ve[0],Oe=ve[1],ye=Object(r.useState)([]),je=Object(n.a)(ye,2),Se=je[0],we=je[1],Ce=Object(r.useState)(0),xe=Object(n.a)(Ce,2),De=xe[0],He=xe[1],Ne=Object(r.useState)("1"),ke=Object(n.a)(Ne,2),_e=ke[0],Te=ke[1],Ye=Object(r.useState)("1"),Pe=Object(n.a)(Ye,2),Me=Pe[0],Ae=Pe[1],ze=Object(r.useState)([]),Re=Object(n.a)(ze,2),Fe=Re[0],Be=Re[1],Ie=Object(r.useState)([]),We=Object(n.a)(Ie,2),Ke=We[0],qe=We[1],Je=Object(r.useState)(""),$e=Object(n.a)(Je,2),Ge=$e[0],Le=$e[1],Qe=Object(r.useState)([]),Ue=Object(n.a)(Qe,2),Ve=Ue[0],Xe=Ue[1],Ze=Object(r.useState)(""),et=Object(n.a)(Ze,2),tt=et[0],at=et[1],nt=Object(r.useState)(!1),rt=Object(n.a)(nt,2),ct=rt[0],lt=rt[1],it=Object(r.useState)(null),st=Object(n.a)(it,2),ot=st[0],mt=st[1],ut=Object(r.useState)(!1),dt=Object(n.a)(ut,2),pt=dt[0],Et=dt[1],gt=Object(r.useState)(""),bt=Object(n.a)(gt,2),ft=bt[0],vt=bt[1],ht=Object(r.useState)(!1),Ot=Object(n.a)(ht,2),yt=Ot[0],jt=Ot[1],St=Object(r.useState)(""),wt=Object(n.a)(St,2),Ct=wt[0],xt=wt[1],Dt=Object(r.useState)(!1),Ht=Object(n.a)(Dt,2),Nt=Ht[0],kt=Ht[1];Object(r.useEffect)((function(){P()(localStorage.getItem("token"));Object(T.t)().then((function(e){var t=function(e,t){var a=t.slice();return a.unshift(e),a}({_id:"1",type:"Todas",status:"active",tag:""},e.attentionsTypes);Be(t)})),Object(T.D)({}).then((function(e){qe(e.customers)}))}),[]);var _t=function(e){var t=void 0!==e?e:Ge;return null==t||""===t.toString().trim()?(Et(!0),vt("Este campo es requerido"),1):(Et(!1),vt(""),0)},Tt=function(e){var t=void 0!==e?e:tt;return null==t||""===t.toString().trim()?(jt(!0),xt("Este campo es requerido"),1):(jt(!1),xt(""),0)},Yt=function(){be(!1)},Pt=function(e){if(0===function(){var e=0,t=P()(localStorage.getItem("token"));return"5a046fe9627e3526802b3847"!==t.role&&(e+=_t()),"627d968a96a6a6b76f30c7e9"==t.role&&(e+=Tt()),e}()){var t={start:0,end:X,paginate:!0,startDate:ie,endDate:ue,customer:Ge,centerOfAttention:tt,serviceType:_e,serviceStatus:Me,source:"web"};Object(T.c)(t).then((function(e){var t=0;ne(e.count);var a=e.attentions.map((function(e,a){return console.log("service ",e.total),e.total&&(t+=e.total),e}));we(a),He(t)}))}},Mt=function(e){return function(){lt(!0),mt(e)}},At=function(){lt(!1)},zt=function(e){switch(e.statusSend){case"send":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Enviado"),c.a.createElement("div",{className:"dateHistory"},y()(e.date).format("YYYY-MM-DD HH:mm:ss")));case"resend":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Reenviado"),c.a.createElement("div",{className:"dateHistory"},y()(e.date).format("YYYY-MM-DD HH:mm:ss")));case"reject":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Rechazado"),c.a.createElement("div",{className:"dateHistory"},y()(e.date).format("YYYY-MM-DD HH:mm:ss")));case"accept":return c.a.createElement("div",{className:"wrapper__history"},c.a.createElement("div",{className:"statusHistory"},"Aceptado"),c.a.createElement("div",{className:"dateHistory"},y()(e.date).format("YYYY-MM-DD HH:mm:ss")))}},Rt=function(e){return function(){var t=Se.map((function(t){return t._id===e._id&&(t.downloading=!0),t}));we(t);var a={id:e._id};Object(T.K)(a).then((function(t){var a=Se.map((function(t){return t._id===e._id&&(t.downloading=!1),t}));we(a),console.log(t),"success"===t.status?(U.b.info(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),we(a),window.open("".concat(C.a.urlPdf).concat(e._id,".pdf"))):U.b.error(t.message,{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})})).catch((function(e){U.b.error("Occurri\xf3 un error al descargar la atenci\xf3n",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}))}};return c.a.createElement(r.Fragment,null,c.a.createElement(U.a,null),c.a.createElement(o.a,{maxWidth:"lg"},c.a.createElement(i.a,{className:re.paper},c.a.createElement("form",{encType:"multipart/form-data",onSubmit:function(e){e.preventDefault(),Pt()}},c.a.createElement(s.a,{container:!0},c.a.createElement(s.a,{item:!0,xs:12,sm:12},c.a.createElement(m.a,null,c.a.createElement("b",null,"Reporte de atenciones"))),c.a.createElement(s.a,{item:!0,xs:12,sm:3},c.a.createElement(q.a,{utils:K.a},c.a.createElement(J.a,{disableFuture:!0,format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha inicial",value:ie,onChange:function(e){se(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),c.a.createElement(s.a,{item:!0,xs:12,sm:3},c.a.createElement(q.a,{utils:K.a},c.a.createElement(J.a,{format:"yyyy-MM-dd",margin:"dense",id:"date-picker-inline",label:"Fecha final",value:ue,onChange:function(e){de(e)},KeyboardButtonProps:{"aria-label":"change date"}}))),c.a.createElement(s.a,{item:!0,xs:12,sm:3},c.a.createElement(k.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Cliente",error:pt,helperText:ft,value:Ge,onChange:function(e){var t=P()(localStorage.getItem("token")),a={};"5a046fe9627e3526802b3847"==t.role&&(a.customer=""),"5a046fe9627e3526802b3848"==t.role&&(a.customer=e.target.value),"627d968a96a6a6b76f30c7e9"==t.role&&(a.encargado=!0,a.user=t.id),console.log("filters",a),Le(e.target.value),Object(T.C)(a).then((function(e){Xe(e.centersOfAttention)}))}},Ke.map((function(e){return c.a.createElement(_.a,{key:e._id,value:e._id},e.name)})))),c.a.createElement(s.a,{item:!0,xs:12,sm:3},c.a.createElement(k.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Centro de atenci\xf3n",error:yt,helperText:Ct,value:tt,onChange:function(e){at(e.target.value)}},Ve.map((function(e){return c.a.createElement(_.a,{key:e._id,value:e._id},e.title)})))),c.a.createElement(s.a,{item:!0,xs:12,sm:3},c.a.createElement(k.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Tipo de atenci\xf3n",value:_e,onChange:function(e){Te(e.target.value)}},Fe.map((function(e){return c.a.createElement(_.a,{key:e._id,value:e._id},e.type)})))),c.a.createElement(s.a,{item:!0,xs:2,sm:3},c.a.createElement(k.a,{select:!0,style:{width:200},variant:"outlined",margin:"dense",label:"Estado de la atenci\xf3n",value:Me,onChange:function(e){Ae(e.target.value)}},[{id:"1",text:"Todas"},{id:"accept",text:"Aceptada"},{id:"reject",text:"Rechazada"},{id:"resend",text:"Reenviada"}].map((function(e){return c.a.createElement(_.a,{key:e.id,value:e.id},e.text)})))),c.a.createElement(s.a,{item:!0,xs:2,sm:12},c.a.createElement(u.a,{type:"submit",variant:"contained",color:"primary",style:{marginTop:20}},"Consultar")))))),c.a.createElement(i.a,{className:re.paper},c.a.createElement(g.a,{className:re.container,style:{width:"100%"}},c.a.createElement(d.a,{stickyHeader:!0,"aria-label":"sticky table"},c.a.createElement(b.a,null,c.a.createElement(h.a,null,c.a.createElement(E.a,null,"Fecha"),c.a.createElement(E.a,null,"Tipo"),c.a.createElement(E.a,null,"Cliente"),c.a.createElement(E.a,null,"Nombre"),c.a.createElement(E.a,null,"Descripci\xf3n"),c.a.createElement(E.a,null,"Centro de atenci\xf3n"),c.a.createElement(E.a,{width:30},"Historial"),c.a.createElement(E.a,{width:30},"Descargar"),c.a.createElement(E.a,{width:30,align:"right"},"Total"))),c.a.createElement(p.a,null,Se.map((function(e){return c.a.createElement(h.a,{hover:!0,key:e._id},c.a.createElement(E.a,null,c.a.createElement(S.a,{format:"ll"},new Date(e.date))),c.a.createElement(E.a,null,e.attentionType.type),c.a.createElement(E.a,null,e.customer.name),c.a.createElement(E.a,null,e.title),c.a.createElement(E.a,null,e.description),c.a.createElement(E.a,null,e.centerOfAttention?e.centerOfAttention.title:""),c.a.createElement(E.a,{className:re.iconWidth},e.descriptions.length>0?c.a.createElement(M.a,{title:"Hisotoria",placement:"top"},c.a.createElement("div",null,c.a.createElement(A.b,{className:"icon",onClick:Mt(e)}))):""),c.a.createElement(E.a,{className:re.iconWidth},c.a.createElement(M.a,{title:"Descargar",placement:"top"},e.downloading?c.a.createElement("div",{className:"circularProgress"},c.a.createElement(W.a,{size:16})):c.a.createElement("div",null,c.a.createElement(G.c,{className:"icon",onClick:Rt(e)})))),c.a.createElement(E.a,{align:"right"},c.a.createElement(w.a,{value:e.total,displayType:"text",thousandSeparator:!0,prefix:"$"})))}))),Se.length>0?c.a.createElement(f.a,null,c.a.createElement(h.a,{hover:!0},c.a.createElement(E.a,null,Nt?c.a.createElement(W.a,{size:16}):c.a.createElement($.b,{className:re.icon,onClick:function(){kt(!0);var e={start:0,end:X,paginate:!0,startDate:ie,endDate:ue,customer:Ge,centerOfAttention:tt,serviceType:_e,serviceStatus:Me,source:"web"};Object(T.T)(e).then((function(e){if(kt(!1),"success"===e.status){var t="data:application/pdf;base64,"+e.data;Oe(t),be(!0)}})).catch((function(e){console.log(e),kt(!1)}))}})),c.a.createElement(E.a,{colSpan:8,align:"right"},c.a.createElement(m.a,{variant:"h3"},c.a.createElement(w.a,{value:De,displayType:"text",thousandSeparator:!0,prefix:"$"}))))):"")),c.a.createElement(v.a,{rowsPerPageOptions:[10,25,100],component:"div",count:ae,rowsPerPage:X,page:l,onChangePage:function(e,t){var a={start:t*X,end:X,paginate:!0,startDate:ie,endDate:ue,customer:Ge,centerOfAttention:tt,serviceType:_e,serviceStatus:Me,source:"web"};O(t),Object(T.c)(a).then((function(e){we(e.attentions),ne(e.count)}))},onChangeRowsPerPage:function(e){Z(+e.target.value),O(0);var t={start:0,end:e.target.value,paginate:!0,startDate:ie,endDate:ue,customer:Ge,centerOfAttention:tt,serviceType:_e,serviceStatus:Me,source:"web"};Object(T.c)(t).then((function(e){we(e.attentions),ne(e.count)}))}})),c.a.createElement(x.a,{maxWidth:"lg",open:ge,onClose:Yt,"aria-labelledby":"draggable-dialog-title"},c.a.createElement(N.a,{id:"draggable-dialog-title"},"Reporte de servicios"),c.a.createElement(H.a,null,c.a.createElement("iframe",{src:he,title:"Imprimir",height:"900px",width:"600px"})),c.a.createElement(D.a,null,c.a.createElement(u.a,{onClick:Yt,color:"primary"},"Cerrar"))),c.a.createElement(x.a,{open:ct,onClose:At},c.a.createElement(N.a,null,"Historia"),c.a.createElement(H.a,null,c.a.createElement(I.a,null,c.a.createElement(z.a,{className:re.root},ot?ot.descriptions.map((function(e){return c.a.createElement(R.a,{alignItems:"flex-start"},c.a.createElement(B.a,null,function(e){switch(e){case"reject":return c.a.createElement(G.b,{style:{fontSize:32,color:"red"}});case"send":return c.a.createElement(L.d,{style:{fontSize:32,color:"red"}});case"accept":return c.a.createElement(G.a,{style:{fontSize:32,color:"green"}});case"resend":return c.a.createElement(Q.a,{style:{fontSize:32,color:"silver"}})}}(e.statusSend)),c.a.createElement(F.a,{primary:zt(e),secondary:e.description}))})):""))),c.a.createElement(D.a,null,c.a.createElement(u.a,{autoFocus:!0,onClick:At,color:"primary"},"Cerrar"))))}}}]);
//# sourceMappingURL=23.5f94bd47.chunk.js.map